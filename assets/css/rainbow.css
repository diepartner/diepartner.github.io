/* rainbow.css
   Rainbow-like wake animation constrained to viewport.
   Minimal: only necessary code retained. Two-space indentation.
*/

:root {
  --duration: 6.5s;
  --delay: 0s;
  --scale: 0.98;
  --width: 220px;       /* base wake width */
  --height: 22px;
  --bottom: 9vh;
  --safe-margin: 4vw;   /* margin from viewport edges to keep wake visible */
}

/* Decorative rainbow-like wake attached to .box so it can be triggered by hover/focus/touch.
   Note: placing the fixed-position wake on .box::after lets us toggle it with .box:hover
   and .box:focus-within in pure CSS. This avoids needing JavaScript to toggle a global
   :root::before element from a child element.
*/
.box::after {
  content: "";
  position: fixed;
  bottom: calc(var(--bottom) - 12px);
  left: var(--safe-margin);
  width: calc(var(--width) * 1.25);
  height: var(--height);
  pointer-events: none;
  z-index: 9998;
  transform-origin: left center;
  transform: translateX(0) scaleX(0.95);
  opacity: 0;
  background: linear-gradient(
    90deg,
    #ffd580 0%,
    #ff9aa2 28%,
    #ff6b6b 42%,
    #9ad3ff 62%,
    #6bb0ff 72%,
    #c38cff 90%
  );
  border-radius: 999px;
  filter: blur(6px) saturate(120%);
  mix-blend-mode: screen;
  will-change: transform, opacity, filter;
  /* Keep animations defined but do not autoplay; they'll be enabled by the trigger */
  animation: none;
  max-width: calc(100vw - (var(--safe-margin) * 2)); /* never wider than visible area */
  transition: opacity 220ms cubic-bezier(.22,.9,.3,1), transform 220ms cubic-bezier(.22,.9,.3,1);
}

/* Activate animations when .box is hovered/focused-within (desktop/keyboard) or when heading is active (touch)
   - .box:hover::after covers mouse hover
   - .box:focus-within::after covers keyboard focus when heading receives tabindex="0"
   - .box h1:active::after aims to cover quick touch press on the heading (some mobile browsers apply :active)
   Note: Some mobile browsers do not expose a persistent :hover state; tapping will show the animation
   only while the element is active â€” which is typically acceptable for a transient wake effect.
*/
.box:hover::after,
.box:focus-within::after,
.box h1:active::after {
  animation:
    enter 900ms cubic-bezier(.22, .9, .3, 1) forwards,
    move calc(var(--duration) * 0.98) ease-in-out var(--delay) infinite alternate,
    shimmer 10s ease-in-out 2s infinite;
  opacity: 0.95;
}

/* Entrance */
@keyframes enter {
  from {
    transform: translateX(-120px) translateY(12px) scale(.5);
    opacity: 0;
    filter: blur(8px);
  }
  to {
    transform: translateX(0) translateY(0) scale(1);
    opacity: 0.95;
    filter: none;
  }
}

/* Horizontal travel constrained to remain within safe margins.
   We animate translateX by percentage of the available horizontal range.
   This preserves the intended "wake travels across the width of the viewport"
   while respecting --safe-margin so it never runs off-screen.
*/
@keyframes move {
  0% {
    transform: translateX(0) scaleX(0.95);
    opacity: 0.85;
  }
  50% {
    transform: translateX(calc((100vw - (var(--safe-margin) * 2) - 100%) * 0.5)) scaleX(1.02) translateY(-6px);
    opacity: 1;
  }
  100% {
    transform: translateX(calc(100vw - (var(--safe-margin) * 2) - 100%)) scaleX(0.95);
    opacity: 0.85;
  }
}

/* Gentle color/saturation shimmer */
@keyframes shimmer {
  0% {
    filter: hue-rotate(0deg) saturate(100%);
  }
  50% {
    filter: hue-rotate(6deg) saturate(112%);
  }
  100% {
    filter: hue-rotate(0deg) saturate(100%);
  }
}

/* Reduced-motion preference */
@media (prefers-reduced-motion: reduce) {
  .box::after {
    animation: none !important;
    transform: translateX(var(--safe-margin)) scale(0.95) !important;
    opacity: 1 !important;
    filter: none !important;
  }
}

/* Ensure the calc() expressions behave in older engines by providing a fallback:
   If calc(...) in keyframes is unsupported, the animation will still run but with smaller movement.
*/
